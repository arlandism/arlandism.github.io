---
layout: article
title: Are My Tests Worth It?
date: '2013-12-03T20:18:00.002-08:00'
author: aml
tags:
- apprenticeship
modified_time: '2013-12-03T20:18:44.976-08:00'
blogger_id: tag:blogger.com,1999:blog-1730093662423317857.post-2337336865145598548
blogger_orig_url: https://immutablearlandis.blogspot.com/2013/12/are-my-tests-worth-it.html
---

Phil and I wrote some tests today that I wasn't happy with. We were working on a function "hit-api?" that takes a widget (in keyword form) and returns a boolean based on whether or not a certain amount of time has expired since the last call to that widget's API.&nbsp;<div><br /></div><div>Our baseline expiration time is 10 minutes. After the first two tests, one for the true case and one for the false, we noticed a trend where each subsequent test looked identical; the only variation was the widget type.&nbsp;</div><div><br /></div><div>"(describe 'hit-api?'</div><div><br /></div><div>&nbsp; &nbsp; (context 'blog'</div><div>&nbsp; &nbsp; &nbsp; (it 'returns true when ten minutes has elapsed since the last api call'</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(with-redefs [blog-response (atom {:last-update 'more than ten minutes ago'})]</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(should= true (hit-api? :blog)))</div><div><br /></div><div>&nbsp; &nbsp; &nbsp; (it 'returns false when less than ten minutes have passed'</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(with-redefs [blog-response (atom {:last-update 'less than ten minutes ago'})]</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(should= false (hit-api? :blog))</div><div>&nbsp; &nbsp;&nbsp;</div><div>&nbsp; &nbsp; (context 'other-widget'</div><div>&nbsp; &nbsp; &nbsp; &nbsp;(it 'returns true when ten minutes has elapsed since the last api call'</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (with-redefs [other-widget-response (atom {:last-update 'more than ten minutes ago'})]</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (should= true (hit-api? :other-widget)))</div><div><br /></div><div>&nbsp; &nbsp; &nbsp; &nbsp;(it 'returns false when less than ten minutes have passed'</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (with-redefs [other-widget-response (atom {:last-update 'less than ten minutes ago'})]</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(should= false (hit-api? :other-widget)))))</div><div>"</div><div>We found ourselves copy/pasting test code and just changing the widget type. This made me extremely uneasy. To me, it seems like tests that trivial to write either aren't worth writing, or can be simplified dramatically.</div><div><br /></div><div>I'm not sure which direction we should go in. There seems to be a couple of different alternatives:</div><div><ol><li>Refactor the tests to make them less duplicitous.</li><li>Rethink the production code. If the tests are stupid then maybe the production code is stupid. Or, maybe the production code can be simplified enough to where it's just data and shouldn't be tested. Right now, there's logic in the comparison of the widget response's last update to the current time.</li></ol></div>
