---
layout: article
title: 'Feature Wrapped: What Now?'
date: '2013-08-31T21:25:00.000-07:00'
author: aml
tags: 
modified_time: '2013-08-31T21:26:55.815-07:00'
blogger_id: tag:blogger.com,1999:blog-1730093662423317857.post-4001861206508579864
blogger_orig_url: https://immutablearlandis.blogspot.com/2013/08/feature-wrapped-what-now.html
---

I just got the latest feature to my Sinatra application done: the option to move first or second versus the computer. It was very rewarding, and difficult, to get it finished. Now that it's complete, there are a couple of refactoring choices that I need to consider.<br /><br /><b>Design Refactor</b><br /><b><br /></b>Design changes are typically frowned upon unless they're really needed. I'm not sure if my application calls for one. On one hand, I really would like to do something about the cookie problem that's been bugging me. On the other hand, I have been able to add features without it being terribly overcomplicated. I just worry that I'm missing some kind of blissful simplicity that's staring me in the face. Right now, I use cookies to pass around relevant information between the routing functions in the controllers. Maybe there's some other mechanism I could use to accomplish this goal. But why fix what isn't really broken? I'm not sure what to do here. I really want to slightly modify the design, but I worry about overcomplicating things like I did in my last refactor.<br /><br /><b>Preparation Refactor</b><br /><b><br /></b>Are there things in my code that would make adding the next feature simpler? If so, I should probably get on that. But, I'm not sure if there is anything I could do to prepare other than modify the design. I'm going to do a double-take to make sure, but I don't know if there's anything I could do to prep.<br /><br /><b>Test Refactor</b><br /><b><br /></b>I'm not satisfied with my tests. They work in the sense that if I modify something without modifying a test, tests will break. This is good because it means I've been testing all parts of the code. I think the tests are high-level enough not to be fragile, but low-level enough that they test small pieces of functionality. Their overall design leaves something to be desired though. I don't like how I have to keep track of what I need to stub out in every test in order for it to work. I'm finding that this is a lot of overhead in writing what would otherwise be fairly simple tests. I'm not sure if there's a way around this though since the implementation code relies on a service. Stubbing out that service call seems like the only way to get around that.<br /><br /><b>Summary</b><br /><b><br /></b>It looks like I'll need to do a refactoring of some sort in any case. The design refactor would be pretty radical so I think I'll stay away from that if possible. I think that the test refactor should take precedence since I don't think it would take very long. After that, I'll probably search through my code for any tweaks I could make that will make the next story easier to implement.
