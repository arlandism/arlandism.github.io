---
layout: article
title: Networks decreasing my net work
date: '2013-07-31T15:03:00.002-07:00'
author: aml
tags: 
modified_time: '2013-07-31T15:03:24.478-07:00'
blogger_id: tag:blogger.com,1999:blog-1730093662423317857.post-3184620257552617132
blogger_orig_url: https://immutablearlandis.blogspot.com/2013/07/networks-decreasing-my-net-work.html
---

Work was pretty tough today. I've been stuck on the same bug for most of the day. The gist of it is that there's a Python server socket connected to a Ruby client socket. Both sides of the conversation speak JSON so that's what they send their messages through. The problem is that there's a lot of building up to this conversation. The server has to get started and return a connection socket. This connection socket is what actually does the talking to the Ruby socket. This is what the Python looks like so far:<br /><br /><pre class="brush:python" name="code">MAX_BYTE_SIZE = 4096<br />server = ServerSocket("localhost",6000)<br />computer = minimax.Minimax("o",20)<br />server.initialize_and_listen_for_connections()<br />connection_socket = server.accept_connection_and_return_socket()<br />board = BaseBoard(3)<br />while True:<br />    data = connection_socket.recv(MAX_BYTE_SIZE)<br />    string = handle_junk(data)<br />    decoded = try_json_load(string)<br />    decoded = replace_string_keys_with_ints(decoded)<br />    board.board_state = decoded<br />    computer_move = computer.next_move(board)<br />    encoded = jsonify(computer_move)<br />    connection_socket.send(encoded)<br /></pre>There are some helper functions in there that aren't defined but I hope the code is easy enough to read without showing them. The functions "handle_junk" and "try_json_load" are the ones that I wrote to try and deal with the formatting coming through the sockets. Sometimes there are newlines appended to the ends of strings and sometimes I get null values. Needless to say, this is very annoying. And there's no really graceful way to avoid these errors. I was hoping to just spit out some "" when things mess up, but that's not working either. Not really sure what to do here.   One glaring problem with this code is that there's a lot going on. It would be fine if there were no logic involved, but this level of complexity should be separated between some levels of abstraction. It would certainly be easier to trace down any bugs then. But, then I'd worry about the time constraints and all of that new code I'd have to write. I think the best solution right now is to take a step back and try to narrow the problem scope. Then I can develop a plan of attack for treating the error.
